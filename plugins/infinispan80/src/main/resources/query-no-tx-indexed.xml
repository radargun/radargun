<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright 2013 Red Hat, Inc. and/or its affiliates.
  ~
  ~ This is free software; you can redistribute it and/or modify it
  ~ under the terms of the GNU Lesser General Public License as
  ~ published by the Free Software Foundation; either version 2.1 of
  ~ the License, or (at your option) any later version.
  ~
  ~ This software is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  ~ Lesser General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Lesser General Public
  ~ License along with this library; if not, write to the Free Software
  ~ Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
  ~ 02110-1301 USA
  -->

<infinispan
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="urn:infinispan:config:7.0 http://www.infinispan.org/schemas/infinispan-config-7.0.xsd"
        xmlns="urn:infinispan:config:7.0">

    <jgroups>
        <stack-file name="jgroupsStack" path="${infinispan.jgroups.config:jgroups-udp-custom.xml}"/>
    </jgroups>

    <cache-container name="default" default-cache="default">
        <transport stack="jgroupsStack" lock-timeout="600000" cluster="default" />
        <serialization></serialization>
        <jmx duplicate-domains="true">
            <property name="enabled">true</property>
        </jmx>
        <local-cache name="default" />

       <distributed-cache name="dist_lucene" owners="2" segments="512">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="LOCAL">
             <property name="default.indexmanager">org.infinispan.query.indexmanager.InfinispanIndexManager</property>
             <property name="default.exclusive_index_use">true</property>
             <property name="default.metadata_cachename">lucene_metadata_repl</property>
             <property name="default.data_cachename">lucene_data_dist</property>
             <property name="default.locking_cachename">lucene_locking_repl</property>
          </indexing>
       </distributed-cache>

       <distributed-cache name="dist_lucene_repl" owners="2" segments="512">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="LOCAL">
             <property name="default.indexmanager">org.infinispan.query.indexmanager.InfinispanIndexManager</property>
             <property name="default.exclusive_index_use">true</property>
             <property name="default.metadata_cachename">lucene_metadata_repl_for_repl</property>
             <property name="default.data_cachename">lucene_data_repl</property>
             <property name="default.locking_cachename">lucene_locking_repl_for_repl</property>
          </indexing>
       </distributed-cache>

       <distributed-cache name="dist_lucene_repl_async1" owners="2" segments="512">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="LOCAL">
             <property name="default.indexmanager">org.infinispan.query.indexmanager.InfinispanIndexManager</property>
             <property name="default.exclusive_index_use">true</property>
             <property name="default.worker.execution">async</property>
             <property name="default.worker.thread_pool.size">8</property>
             <property name="default.worker.buffer_queue.max">1000</property>
             <property name="default.metadata_cachename">lucene_metadata_repl_for_repl_async1</property>
             <property name="default.data_cachename">lucene_data_repl_async1</property>
             <property name="default.locking_cachename">lucene_locking_repl_for_repl_async1</property>
          </indexing>
       </distributed-cache>

       <distributed-cache name="dist_lucene_repl_async8" owners="2" segments="512">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="LOCAL">
             <property name="default.indexmanager">org.infinispan.query.indexmanager.InfinispanIndexManager</property>
             <property name="default.exclusive_index_use">true</property>
             <property name="default.worker.execution">async</property>
             <property name="default.worker.thread_pool.size">8</property>
             <property name="default.worker.buffer_queue.max">1000</property>
             <property name="default.metadata_cachename">lucene_metadata_repl_for_repl_async8</property>
             <property name="default.data_cachename">lucene_data_repl_async8</property>
             <property name="default.locking_cachename">lucene_locking_repl_for_repl_async8</property>
          </indexing>
       </distributed-cache>

       <replicated-cache name="repl_ram">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="ALL">
             <property name="default.directory_provider">ram</property>
             <property name="default.indexmanager">near-real-time</property>
             <property name="default.exclusive_index_use">true</property>
          </indexing>
       </replicated-cache>

       <replicated-cache name="repl_fs">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="ALL">
             <property name="default.directory_provider">filesystem</property>
             <property name="default.indexmanager">near-real-time</property>
             <property name="default.indexBase">/tmp/ispn_fs_index/${log4j.file.prefix}</property>
             <property name="default.exclusive_index_use">true</property>
          </indexing>
       </replicated-cache>


       <local-cache name="local_ram">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="ALL">
             <property name="default.directory_provider">ram</property>
             <property name="default.indexmanager">near-real-time</property>
             <property name="default.exclusive_index_use">true</property>
          </indexing>
       </local-cache>

       <local-cache name="local_fs">
          <locking acquire-timeout="3000" concurrency-level="1000" />
          <transaction mode="NONE"/>

          <indexing index="ALL">
             <property name="default.directory_provider">filesystem</property>
             <property name="default.indexmanager">near-real-time</property>
             <property name="default.indexBase">/tmp/ispn_fs_index/${log4j.file.prefix}</property>
             <property name="default.exclusive_index_use">true</property>
          </indexing>
       </local-cache>

       <replicated-cache name="lucene_metadata_repl" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>
       <distributed-cache name="lucene_data_dist" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </distributed-cache>
       <replicated-cache name="lucene_locking_repl" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>

       <replicated-cache name="lucene_metadata_repl_for_repl" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>
       <replicated-cache name="lucene_data_repl" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>
       <replicated-cache name="lucene_locking_repl_for_repl" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>

       <replicated-cache name="lucene_metadata_repl_for_repl_async1" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>
       <replicated-cache name="lucene_data_repl_async1" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>
       <replicated-cache name="lucene_locking_repl_for_repl_async1" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>

       <replicated-cache name="lucene_metadata_repl_for_repl_async8" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>
       <replicated-cache name="lucene_data_repl_async8" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>
       <replicated-cache name="lucene_locking_repl_for_repl_async8" mode="SYNC" remote-timeout="25000">
          <indexing index="NONE" />
       </replicated-cache>

    </cache-container>

</infinispan>
